(this["webpackJsonprestaurant-review-site"]=this["webpackJsonprestaurant-review-site"]||[]).push([[0],{19:function(e,n,t){e.exports=t.p+"static/media/logo.7e873e41.svg"},22:function(e,n,t){e.exports=t(31)},31:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),i=t(15),o=t.n(i);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=t(1),c=t(2);function l(){var e=Object(s.a)(["\n  body {\n    margin: 0;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n}"]);return l=function(){return e},e}var u=Object(c.a)(l()),d=t(20),p=t(11),f=t(4),m=t(5),g=t(7),h=t(6),v=t(8),b=t(10),w=t.n(b),R=t(3),y=t.n(R),k=t(19),x=t.n(k);function O(){var e=Object(s.a)(["\n  display: flex;\n  flex-flow: row nowrap;\n  width: 100%;\n  height: 100%;\n  overflow-x: hidden;\n  overflow-y: auto;\n  > * {\n    transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);\n    visibility: hidden;\n    opacity: 0;\n    width: 0;\n\n    &.selected {\n      visibility: visible;\n      opacity: 1;\n      width: 100%;\n      margin-left: 0px;\n      overflow-y: inherit;\n    }\n\n    &:first-child:not(.selected) {\n      width: 100%;\n      margin-left: -100%;\n      opacity: 0;\n      overflow-y: hidden;\n    }\n  }\n"]);return O=function(){return e},e}function E(){var e=Object(s.a)(["\n  background: #3c3b3f; /* fallback for old browsers */\n  background: linear-gradient(to right, #605c3c, #3c3b3f);\n  width: 20%;\n  min-width: 300px;\n  height: 85vh;\n  overflow-x: hidden;\n  display: flex;\n  flex-direction: column;\n"]);return E=function(){return e},e}function S(){var e=Object(s.a)(["\n  background-color: orange;\n  width: 80%;\n  height: 85vh;\n  overflow-x: hidden;\n  position: relative;\n"]);return S=function(){return e},e}function C(){var e=Object(s.a)(["\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  box-sizing: border-box;\n"]);return C=function(){return e},e}function j(){var e=Object(s.a)(["\n  width: 100%;\n  background: #00b4db; /* fallback for old browsers */\n  background: linear-gradient(to right, #00b4db, #0083b0);\n  height: calc(15vh - 10px);\n  padding-top: 10px;\n  p {\n    margin: 5px 0px;\n  }\n"]);return j=function(){return e},e}function M(){var e=Object(s.a)(["\n  height: 48px;\n  pointer-events: none;\n\n  @keyframes App-logo-spin {\n    from {\n      transform: rotate(0deg);\n    }\n    to {\n      transform: rotate(360deg);\n    }\n  }\n\n  @media (prefers-reduced-motion: no-preference) {\n    & {\n      animation: App-logo-spin infinite 4s linear;\n    }\n  }\n"]);return M=function(){return e},e}function P(){var e=Object(s.a)(["\n  text-align: center;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  font-size: calc(8px + 2vmin);\n  color: white;\n"]);return P=function(){return e},e}var N=c.b.div(P()),L=c.b.img.attrs({src:x.a,alt:"logo"})(M()),A=c.b.header(j()),z=c.b.main(C()),H=c.b.section(S()),B=c.b.section(E()),I=c.b.div(O()),W=r.a.forwardRef((function(e,n){var t=e.children;return r.a.createElement(B,null,r.a.createElement(I,{ref:n},t))}));W.displayName="SectionRight",W.propTypes={children:y.a.oneOfType([y.a.string,y.a.arrayOf(y.a.node),y.a.node]).isRequired};var F={Root:N,AppLogo:L,Header:A,Body:z,SectionLeft:H,SectionRight:W};var G=function(e){var n=e.leftSide,t=e.rightSide;return r.a.createElement(F.Root,null,r.a.createElement(F.Header,null,r.a.createElement(F.AppLogo,null),r.a.createElement("p",null,"Restaurant review.")),r.a.createElement(F.Body,null,r.a.createElement(F.SectionLeft,null,n),r.a.createElement(F.SectionRight,null,t)))};function T(){var e=Object(s.a)(["\n  border: 1px solid gray;\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n  width: calc(100% - 5px);\n  height: 150px;\n"]);return T=function(){return e},e}function D(){var e=Object(s.a)(["\n  background-color: #0074d9;\n  border-radius: 4px;\n  box-shadow: 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14),\n    0 1px 5px 0 rgba(0, 0, 0, 0.12);\n  color: white;\n  font-weight: bold;\n  overflow: hidden;\n  border: none;\n  padding: 7px;\n\n  &::after {\n    clear: both;\n  }\n  &::after,\n  &::before {\n    content: '';\n    display: block;\n  }\n\n  &:focus {\n    background-color: #7fdbff;\n  }\n\n  &:hover {\n    background-color: #7fdbff;\n    cursor: pointer;\n  }\n"]);return D=function(){return e},e}function U(){var e=Object(s.a)(["\n  background-color: #fff;\n  border-radius: 4px;\n  box-shadow: 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14),\n    0 1px 5px 0 rgba(0, 0, 0, 0.12);\n  color: rgba(0, 0, 0, 0.87);\n  overflow: hidden;\n  border: none;\n  font: inherit;\n  width: 250px;\n  min-height: 50px;\n\n  padding: 5px;\n\n  &::after {\n    clear: both;\n  }\n  &::after,\n  &::before {\n    content: '';\n    display: block;\n  }\n\n  &:focus {\n    background-color: gray;\n  }\n\n  &:hover {\n    background-color: lightgray;\n  }\n"]);return U=function(){return e},e}function q(){var e=Object(s.a)(["\n  list-style: none;\n  width: 100%;\n  margin: 0 0 10px 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  padding: 5px;\n"]);return q=function(){return e},e}function X(){var e=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n  margin: 0;\n  padding: 15px 0 0 0;\n  overflow-x: hidden;\n  overflow-y: auto;\n"]);return X=function(){return e},e}var Y=c.b.ul(X()),J=c.b.li(q()),Q=c.b.div(U()),_=c.b.button.attrs({type:"button"})(D()),V=c.b.img(T()),$=r.a.forwardRef((function(e,n){var t=e.onClick,a=e.children,i=e.imageSrc;return r.a.createElement(J,null,r.a.createElement(Q,{onClick:t,ref:n},r.a.createElement(V,{src:i}),a))}));$.displayName="RestaurantsListCard",$.propTypes={onClick:y.a.func,children:y.a.oneOfType([y.a.string,y.a.arrayOf(y.a.node),y.a.node]).isRequired,imageSrc:y.a.string.isRequired},$.defaultProps={onClick:function(){}};var K={List:Y,Card:$,ButtonReviews:_},Z=function(e){if(!e)return 0;var n=Number(e-Math.floor(e)),t=Number(n<.5&&n>0?.5:0);return t=Number(0===t&&n>.5?1:.5),Math.floor(e)+t},ee=function(e){function n(){return Object(f.a)(this,n),Object(g.a)(this,Object(h.a)(n).apply(this,arguments))}return Object(v.a)(n,e),Object(m.a)(n,[{key:"renderRestaurants",value:function(){var e=this.props,n=e.restaurants,t=e.onClickRestaurant,a=e.onClickRestaurantRate;return n.map((function(e){var n=e.id,i=e.restaurantName,o=e.position,s=e.rating,c=e.rates.length?r.a.createElement(K.ButtonReviews,{onClick:function(){t(e)}},"View Reviews ",e.rates.length):null;return r.a.createElement(K.Card,{key:n,imageSrc:"https://maps.googleapis.com/maps/api/streetview?size=300x300&location=".concat(o.lat,",").concat(o.lng,"&fov=80&heading=70&pitch=0&key=AIzaSyBwYHIy3nSGNk4Tm-HfoXQpOHbGEyA-RmA")},r.a.createElement("span",{title:s||""},r.a.createElement(w.a,{initialRating:Z(Number(s)),isHalfRating:!0,size:20,handleOnClick:function(n){Object.assign(e).newRate={comment:"",rating:n},a(e)}})),c,r.a.createElement("div",null,i))}))}},{key:"render",value:function(){var e=this.props.className,n=this.renderRestaurants();return r.a.createElement(K.List,{className:e},n)}}]),n}(a.Component),ne=t(9);function te(){var e=Object(s.a)(["\n  color: gray;\n  position: absolute;\n  top: 15px;\n  left: 50%;\n  transform: translateX(-50%);\n  z-index: 2000;\n"]);return te=function(){return e},e}function ae(){var e=Object(s.a)(["\n  height: 100%;\n"]);return ae=function(){return e},e}var re={MapContainer:c.b.div(ae()),GettingCurrentPosition:c.b.div(te())},ie=function(e){function n(e){var t;return Object(f.a)(this,n),(t=Object(g.a)(this,Object(h.a)(n).call(this,e))).updateCurrentPositionMarker=function(){var e=Object(ne.a)(t).map,n=window.google.maps,a=n.Animation,r=n.Marker;navigator.geolocation&&(t.setState({gettingCurrentPosition:!0}),navigator.geolocation.getCurrentPosition((function(n){var i=n.coords,o={lat:i.latitude,lng:i.longitude};(0,t.props.onMapLoaded)(e,o),setTimeout((function(){t.setState({gettingCurrentPosition:!1}),new r({map:e,position:o,animation:a.DROP,title:"Your position"}).addListener("click",(function(){e.setCenter(this.getPosition())}))}),400),e.setCenter(o)})))},t.updateRestaurantMarkers=function(){var e=Object(ne.a)(t),n=e.map,a=e.restaurantMarkers,r=e.props.restaurants,i=window.google.maps,o=i.Point,s=i.Size,c=i.Marker,l=i.Animation,u=i.InfoWindow;r.filter((function(e){return!Array.from(a.keys()).includes(e.id)})).forEach((function(e,t){var r=e.id,i=e.icon,d=e.restaurantName,f=e.position,m={url:i,size:new s(64,64),origin:new o(0,0),anchor:new o(17,34),scaledSize:new s(25,25)};setTimeout((function(){var t=new c({map:n,position:f,icon:m,title:d,animation:l.DROP}),i='<img\n              src="https://maps.googleapis.com/maps/api/streetview?size=400x400&location='.concat(f.lat,",").concat(f.lng,'&fov=80&heading=70&pitch=0&key=AIzaSyBwYHIy3nSGNk4Tm-HfoXQpOHbGEyA-RmA"\n              alt=""\n            />\n          '),o=new u({content:i});t.addListener("click",(function(){var e=this;this.map.setCenter(this.getPosition()),Array.from(a.values()).filter((function(e){return e.id!==r})).forEach((function(e){return e.infoWindow.close()})),setTimeout((function(){o.open(e.map,t)}),100)})),a.set(r,Object(p.a)({},e,{marker:t,infoWindow:o}))}),600+20*t)}))},t.mapRef=r.a.createRef(),t.map=null,t.restaurantMarkers=new Map,t.state={gettingCurrentPosition:!1},t}return Object(v.a)(n,e),Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this,n=window.google.maps,t=n.event,a=n.Map;this.map=new a(this.mapRef.current,{center:{lat:20.6995456,lng:-103.35027199999999},zoom:13}),t.addListener(this.map,"click",(function(n){e.addPlace(n)})),this.updateCurrentPositionMarker(),this.updateRestaurantMarkers()}},{key:"addPlace",value:function(e){(0,this.props.onAddPlace)(new(0,window.google.maps.Marker)({position:e.latLng,map:this.map}))}},{key:"getSnapshotBeforeUpdate",value:function(e){var n=this.props,t=n.restaurants,a=n.selectedRestaurant;return e.restaurants!==t?{updateRestaurants:!0}:e.selectedRestaurant!==a&&a.id>0?{updateSelectedRestaurant:!0}:null}},{key:"componentDidUpdate",value:function(e,n,t){if(console.log("trying updating"),t&&t.updateRestaurants&&(console.log("updating"),this.updateRestaurantMarkers()),t&&t.updateSelectedRestaurant){var a=this.props.selectedRestaurant,r=window.google.maps.event.trigger;if(a)r(this.restaurantMarkers.get(a.id).marker,"click");else{var i=this.restaurantMarkers;Array.from(i.values()).forEach((function(e){return e.infoWindow.close()}))}}}},{key:"renderGettingCurrentPositionIndicator",value:function(){return this.state.gettingCurrentPosition?r.a.createElement(re.GettingCurrentPosition,null,"Getting current location from your device\xa0..."):null}},{key:"render",value:function(){var e=this.renderGettingCurrentPositionIndicator();return r.a.createElement(r.a.Fragment,null,e,r.a.createElement(re.MapContainer,{ref:this.mapRef}))}}]),n}(a.Component);ie.defaultProps={selectedRestaurant:null};var oe=function(e){function n(e){var t;return Object(f.a)(this,n),(t=Object(g.a)(this,Object(h.a)(n).call(this,e))).handleMapLoaded=function(e,n){var a=n.lat,r=n.lng,i={location:new window.google.maps.LatLng(a,r),radius:"3000",type:["restaurant"]};new window.google.maps.places.PlacesService(e).nearbySearch(i,(function(e){t.setState({restaurants:e.map((function(e){var n=e.id,t=e.icon,a=e.name,r=e.vicinity,i=e.geometry.location;return{id:n,icon:t,restaurantName:a,address:r,position:{lat:i.lat(),lng:i.lng()},rating:0,rates:[]}}))})}))},t.handleClickRestaurant=function(e){t.setState({selectedRestaurant:e,showReviews:!0})},t.handleClickRestaurantRate=function(e){t.setState({selectedRestaurant:e})},t.handleFormReviewSubmit=function(e){var n=t.state,a=n.restaurants,r=n.selectedRestaurant,i=a.findIndex((function(e){return e.id===r.id}));e.preventDefault(),r.rates.push(Object(p.a)({},r.newRate)),delete r.newRate;var o=r.rates.length;r.rating=r.rates.reduce((function(e,n){return e+n.rating}),0)/o,-1!==i?(r.id="".concat(r.id,".1"),a.splice(i,1,r)):(r.id=(a.length+1).toString(),a.unshift(r),r.marker&&r.marker.setMap(null)),t.setState({restaurants:Object(d.a)(a),selectedRestaurant:null})},t.state={restaurants:[],selectedRestaurant:null,showReviews:!1},t}return Object(v.a)(n,e),Object(m.a)(n,[{key:"renderMap",value:function(){var e=this,n=this.state,t=n.restaurants,a=n.selectedRestaurant;return r.a.createElement(ie,{restaurants:t,selectedRestaurant:a,onMapLoaded:this.handleMapLoaded,onAddPlace:function(n){var t=n.position;e.setState({selectedRestaurant:{id:"0",icon:"https://maps.gstatic.com/mapfiles/place_api/icons/restaurant-71.png",restaurantName:"",address:"",position:{lat:t.lat(),lng:t.lng()},rating:0,rates:[],newRate:{comment:"",rating:0},marker:n}})}})}},{key:"renderFormReviews",value:function(){var e=this,n=this.state,t=n.selectedRestaurant,a=n.showReviews,i=t&&!a?r.a.createElement(w.a,{initialRating:t.newRate.rating,isHalfRating:!0,size:20,handleOnClick:function(n){t.newRate.rating=n,e.setState({selectedRestaurant:t})}}):null,o=t&&"0"===t.id?r.a.createElement("input",{name:"restaurantName",placeholder:"Write the restaurant name",style:{minWidth:"calc(100% - 40px)"},onChange:function(n){t.restaurantName=n.target.value,e.setState({selectedRestaurant:t})},value:t?t.restaurantName:""}):null;return r.a.createElement("form",{className:t&&!a?"selected":"",onSubmit:this.handleFormReviewSubmit},o,i,r.a.createElement("textarea",{name:"comment",style:{minWidth:"calc(100% - 40px)",minHeight:"150px"},placeholder:"Write your review",onChange:function(n){t.newRate.comment=n.target.value,e.setState({selectedRestaurant:t})},value:t&&t.newRate?t.newRate.comment:""}),r.a.createElement("button",{type:"submit"},"Save"))}},{key:"renderReviews",value:function(){var e=this,n=this.state,t=n.selectedRestaurant,a=n.showReviews,i=t&&a?t.rates.map((function(e){return r.a.createElement("div",{key:"".concat(e.comment,"_").concat(e.rating)},r.a.createElement("div",null,e.comment),r.a.createElement(w.a,{initialRating:e.rating,isReadOnly:!0,isHalfRating:!0}),r.a.createElement("hr",null))})):null;return r.a.createElement("div",{className:t&&a?"selected":""},i,r.a.createElement("button",{type:"button",onClick:function(){e.setState({selectedRestaurant:null,showReviews:!1})}},"Back"))}},{key:"renderList",value:function(){var e=this.state,n=e.restaurants,t=e.selectedRestaurant,a=r.a.createElement(ee,{className:t?"":"selected",restaurants:n,onClickRestaurant:this.handleClickRestaurant,onClickRestaurantRate:this.handleClickRestaurantRate});return r.a.createElement(r.a.Fragment,null,a,this.renderFormReviews(),this.renderReviews())}},{key:"render",value:function(){var e=this.renderMap(),n=this.renderList();return r.a.createElement(G,{leftSide:e,rightSide:n})}}]),n}(a.Component);o.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(u,null),r.a.createElement(oe,null)),document.getElementById("app-render")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.17cf92f9.chunk.js.map