(this["webpackJsonprestaurant-review-site"]=this["webpackJsonprestaurant-review-site"]||[]).push([[0],{18:function(e,n,t){e.exports=t.p+"static/media/logo.7e873e41.svg"},21:function(e,n,t){e.exports=t(30)},30:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),i=t(14),o=t.n(i);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=t(1),l=t(2);function c(){var e=Object(s.a)(["\n  body {\n    margin: 0;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n      sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n}"]);return c=function(){return e},e}var u=Object(l.a)(c()),d=t(19),p=t(10),f=t(4),m=t(5),g=t(6),h=t(7),v=t(9),b=t.n(v),w=t(3),R=t.n(w),y=t(18),k=t.n(y);function x(){var e=Object(s.a)(["\n  display: flex;\n  flex-flow: row nowrap;\n  width: 100%;\n  height: 100%;\n  overflow-x: hidden;\n  overflow-y: auto;\n  > * {\n    transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);\n    visibility: hidden;\n    opacity: 0;\n    width: 0;\n\n    &.selected {\n      visibility: visible;\n      opacity: 1;\n      width: 100%;\n      margin-left: 0px;\n      overflow-y: inherit;\n    }\n\n    &:first-child:not(.selected) {\n      width: 100%;\n      margin-left: -100%;\n      opacity: 0;\n      overflow-y: hidden;\n    }\n  }\n"]);return x=function(){return e},e}function E(){var e=Object(s.a)(["\n  background: #3c3b3f; /* fallback for old browsers */\n  background: linear-gradient(to right, #605c3c, #3c3b3f);\n  width: 20%;\n  min-width: 300px;\n  height: 85vh;\n  overflow-x: hidden;\n  display: flex;\n  flex-direction: column;\n"]);return E=function(){return e},e}function S(){var e=Object(s.a)(["\n  background-color: orange;\n  width: 80%;\n  height: 85vh;\n  overflow-x: hidden;\n  position: relative;\n"]);return S=function(){return e},e}function O(){var e=Object(s.a)(["\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  box-sizing: border-box;\n"]);return O=function(){return e},e}function C(){var e=Object(s.a)(["\n  width: 100%;\n  background: #00b4db; /* fallback for old browsers */\n  background: linear-gradient(to right, #00b4db, #0083b0);\n  height: calc(15vh - 10px);\n  padding-top: 10px;\n  p {\n    margin: 5px 0px;\n  }\n"]);return C=function(){return e},e}function j(){var e=Object(s.a)(["\n  height: 48px;\n  pointer-events: none;\n\n  @keyframes App-logo-spin {\n    from {\n      transform: rotate(0deg);\n    }\n    to {\n      transform: rotate(360deg);\n    }\n  }\n\n  @media (prefers-reduced-motion: no-preference) {\n    & {\n      animation: App-logo-spin infinite 4s linear;\n    }\n  }\n"]);return j=function(){return e},e}function M(){var e=Object(s.a)(["\n  text-align: center;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  font-size: calc(8px + 2vmin);\n  color: white;\n"]);return M=function(){return e},e}var P=l.b.div(M()),N=l.b.img.attrs({src:k.a,alt:"logo"})(j()),L=l.b.header(C()),A=l.b.main(O()),z=l.b.section(S()),H=l.b.section(E()),B=l.b.div(x()),F=r.a.forwardRef((function(e,n){var t=e.children;return(r.a.createElement(H,null,r.a.createElement(B,{ref:n},t)))}));F.displayName="SectionRight",F.propTypes={children:R.a.oneOfType([R.a.string,R.a.arrayOf(R.a.node),R.a.node]).isRequired};var I={Root:P,AppLogo:N,Header:L,Body:A,SectionLeft:z,SectionRight:F};var T=function(e){var n=e.leftSide,t=e.rightSide,a=e.filterSpace;return(r.a.createElement(I.Root,null,r.a.createElement(I.Header,null,r.a.createElement(I.AppLogo,null),r.a.createElement("p",null,"Restaurant review."),r.a.createElement("div",{style:{float:"right",marginRight:"20px",marginTop:"-10px"}},a)),r.a.createElement(I.Body,null,r.a.createElement(I.SectionLeft,null,n),r.a.createElement(I.SectionRight,null,t))))};function W(){var e=Object(s.a)(["\n  border: 1px solid gray;\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n  width: calc(100% - 5px);\n  height: 150px;\n"]);return W=function(){return e},e}function G(){var e=Object(s.a)(["\n  background-color: #0074d9;\n  border-radius: 4px;\n  box-shadow: 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14),\n    0 1px 5px 0 rgba(0, 0, 0, 0.12);\n  color: white;\n  font-weight: bold;\n  overflow: hidden;\n  border: none;\n  padding: 7px;\n\n  &::after {\n    clear: both;\n  }\n  &::after,\n  &::before {\n    content: '';\n    display: block;\n  }\n\n  &:focus {\n    background-color: #7fdbff;\n  }\n\n  &:hover {\n    background-color: #7fdbff;\n    cursor: pointer;\n  }\n"]);return G=function(){return e},e}function D(){var e=Object(s.a)(["\n  background-color: #fff;\n  border-radius: 4px;\n  box-shadow: 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14),\n    0 1px 5px 0 rgba(0, 0, 0, 0.12);\n  color: rgba(0, 0, 0, 0.87);\n  overflow: hidden;\n  border: none;\n  font: inherit;\n  width: 250px;\n  min-height: 50px;\n\n  padding: 5px;\n\n  &::after {\n    clear: both;\n  }\n  &::after,\n  &::before {\n    content: '';\n    display: block;\n  }\n\n  &:focus {\n    background-color: gray;\n  }\n\n  &:hover {\n    background-color: lightgray;\n  }\n"]);return D=function(){return e},e}function U(){var e=Object(s.a)(["\n  list-style: none;\n  width: 100%;\n  margin: 0 0 10px 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  padding: 5px;\n"]);return U=function(){return e},e}function q(){var e=Object(s.a)(["\n  display: flex;\n  flex-direction: column;\n  margin: 0;\n  padding: 15px 0 0 0;\n  overflow-x: hidden;\n  overflow-y: auto;\n"]);return q=function(){return e},e}var X=l.b.ul(q()),Y=l.b.li(U()),J=l.b.div(D()),Q=l.b.button.attrs({type:"button"})(G()),_=l.b.img(W()),V=r.a.forwardRef((function(e,n){var t=e.onClick,a=e.children,i=e.imageSrc;return(r.a.createElement(Y,null,r.a.createElement(J,{onClick:t,ref:n},r.a.createElement(_,{src:i}),a)))}));V.displayName="RestaurantsListCard",V.propTypes={onClick:R.a.func,children:R.a.oneOfType([R.a.string,R.a.arrayOf(R.a.node),R.a.node]).isRequired,imageSrc:R.a.string.isRequired},V.defaultProps={onClick:function(){}};var $={List:X,Card:V,ButtonReviews:Q},K=function(e){if(!e)return 0;var n=Number(e-Math.floor(e));if(!n)return e;var t=Number(n<.5&&n>0?.5:0);return t=Number(0===t&&n>.5?1:.5),Math.floor(e)+t},Z=function(e){Object(h.a)(t,e);var n=Object(g.a)(t);function t(){return Object(f.a)(this,t),n.apply(this,arguments)}return Object(m.a)(t,[{key:"renderRestaurants",value:function(){var e=this.props,n=e.filterRating,t=e.restaurants,a=e.onClickRestaurant,i=e.onClickRestaurantRate;return t.filter((function(e){return Math.round(e.rating).toString()===n||"0"===n})).map((function(e){var n=e.id,t=e.restaurantName,o=e.position,s=e.rating,l=e.rates.length?r.a.createElement($.ButtonReviews,{onClick:function(){a(e)}},"View Reviews (",e.rates.length,")"):null;return r.a.createElement($.Card,{key:n,imageSrc:"https://maps.googleapis.com/maps/api/streetview?size=300x300&location=".concat(o.lat,",").concat(o.lng,"&fov=80&heading=70&pitch=0&key=AIzaSyBwYHIy3nSGNk4Tm-HfoXQpOHbGEyA-RmA")},r.a.createElement("span",{title:s?s.toFixed(2):""},r.a.createElement(b.a,{initialRating:K(Number(s)),isHalfRating:!0,size:20,handleOnClick:function(n){Object.assign(e).newRate={comment:"",rating:n},i(e)}})),l,r.a.createElement("div",null,t))}))}},{key:"render",value:function(){var e=this.props.className,n=this.renderRestaurants();return r.a.createElement($.List,{className:e},n)}}]),t}(a.Component),ee=t(8);function ne(){var e=Object(s.a)(["\n  color: gray;\n  position: absolute;\n  top: 15px;\n  left: 50%;\n  transform: translateX(-50%);\n  z-index: 2000;\n"]);return ne=function(){return e},e}function te(){var e=Object(s.a)(["\n  height: 100%;\n"]);return te=function(){return e},e}var ae={MapContainer:l.b.div(te()),GettingCurrentPosition:l.b.div(ne())},re=function(e){Object(h.a)(t,e);var n=Object(g.a)(t);function t(e){var a;return Object(f.a)(this,t),(a=n.call(this,e)).updateCurrentPositionMarker=function(){var e=Object(ee.a)(a).map,n=window.google.maps,t=n.Animation,r=n.Marker;navigator.geolocation&&(a.setState({gettingCurrentPosition:!0}),navigator.geolocation.getCurrentPosition((function(n){var i=n.coords,o={lat:i.latitude,lng:i.longitude};(0,a.props.onMapLoaded)(e,o),setTimeout((function(){a.setState({gettingCurrentPosition:!1}),new r({map:e,position:o,animation:t.DROP,title:"Your position"}).addListener("click",(function(){e.setCenter(this.getPosition())}))}),400),e.setCenter(o)})))},a.updateRestaurantMarkers=function(){var e=Object(ee.a)(a),n=e.map,t=e.restaurantMarkers,r=e.props.restaurants,i=window.google.maps,o=i.Point,s=i.Size,l=i.Marker,c=i.Animation,u=i.InfoWindow;r.filter((function(e){return!Array.from(t.keys()).includes(e.id)})).forEach((function(e,a){var r=e.id,i=e.icon,d=e.restaurantName,f=e.position,m={url:i,size:new s(64,64),origin:new o(0,0),anchor:new o(17,34),scaledSize:new s(25,25)};setTimeout((function(){var a=new l({map:n,position:f,icon:m,title:d,animation:c.DROP}),i='<img\n              src="https://maps.googleapis.com/maps/api/streetview?size=400x400&location='.concat(f.lat,",").concat(f.lng,'&fov=80&heading=70&pitch=0&key=AIzaSyBwYHIy3nSGNk4Tm-HfoXQpOHbGEyA-RmA"\n              alt=""\n            />\n          '),o=new u({content:i});a.addListener("click",(function(){var e=this;this.map.setCenter(this.getPosition()),Array.from(t.values()).filter((function(e){return e.id!==r})).forEach((function(e){return e.infoWindow.close()})),setTimeout((function(){o.open(e.map,a)}),100)})),t.set(r,Object(p.a)({},e,{marker:a,infoWindow:o}))}),600+20*a)}))},a.mapRef=r.a.createRef(),a.map=null,a.restaurantMarkers=new Map,a.state={gettingCurrentPosition:!1},a}return Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this,n=window.google.maps,t=n.event,a=n.Map;this.map=new a(this.mapRef.current,{center:{lat:20.6995456,lng:-103.35027199999999},zoom:13}),t.addListener(this.map,"click",(function(n){e.addPlace(n)})),this.updateCurrentPositionMarker(),this.updateRestaurantMarkers()}},{key:"addPlace",value:function(e){var n=this.props.onAddPlace,t=window.google.maps.Marker;this.addingMarker&&(this.addingMarker.setMap(null),this.addingMarker=null);var a=new t({position:e.latLng,map:this.map});this.addingMarker=a,n(a)}},{key:"getSnapshotBeforeUpdate",value:function(e){var n=this.props,t=n.restaurants,a=n.selectedRestaurant;return e.restaurants!==t?{updateRestaurants:!0}:e.selectedRestaurant!==a&&a&&a.id>0?{updateSelectedRestaurant:!0}:null}},{key:"componentDidUpdate",value:function(e,n,t){if(console.log("trying updating"),t&&t.updateRestaurants&&(console.log("updating"),this.updateRestaurantMarkers()),t&&t.updateSelectedRestaurant){var a=this.props.selectedRestaurant,r=window.google.maps.event.trigger;if(a)r(this.restaurantMarkers.get(a.id).marker,"click");else{var i=this.restaurantMarkers;Array.from(i.values()).forEach((function(e){return e.infoWindow.close()}))}}}},{key:"renderGettingCurrentPositionIndicator",value:function(){return this.state.gettingCurrentPosition?r.a.createElement(ae.GettingCurrentPosition,null,"Getting current location from your device\xa0..."):null}},{key:"render",value:function(){var e=this.renderGettingCurrentPositionIndicator();return(r.a.createElement(r.a.Fragment,null,e,r.a.createElement(ae.MapContainer,{ref:this.mapRef})))}}]),t}(a.Component);re.defaultProps={selectedRestaurant:null};var ie=function(e){Object(h.a)(t,e);var n=Object(g.a)(t);function t(e){var a;return Object(f.a)(this,t),(a=n.call(this,e)).handleMapLoaded=function(e,n){var t=n.lat,r=n.lng,i={location:new window.google.maps.LatLng(t,r),radius:"3000",type:["restaurant"]};new window.google.maps.places.PlacesService(e).nearbySearch(i,(function(e){a.setState({restaurants:e.map((function(e){var n=e.id,t=e.icon,a=e.name,r=e.vicinity,i=e.geometry.location;return{id:n,icon:t,restaurantName:a,address:r,position:{lat:i.lat(),lng:i.lng()},rating:0,rates:[]}}))})}))},a.handleClickRestaurant=function(e){a.setState({selectedRestaurant:e,showReviews:!0})},a.handleClickRestaurantRate=function(e){a.setState({selectedRestaurant:e})},a.handleFormReviewSubmit=function(e){var n=a.state,t=n.restaurants,r=n.selectedRestaurant,i=t.findIndex((function(e){return e.id===r.id}));e.preventDefault(),r.rates.push(Object(p.a)({},r.newRate)),delete r.newRate;var o=r.rates.length;r.rating=r.rates.reduce((function(e,n){return e+n.rating}),0)/o,-1!==i?(r.id="".concat(r.id,".1"),t.splice(i,1,r)):(r.id=(t.length+1).toString(),t.unshift(r),r.marker&&r.marker.setMap(null)),a.setState({restaurants:Object(d.a)(t),selectedRestaurant:null})},a.state={restaurants:[],selectedRestaurant:null,showReviews:!1,filterRating:"0"},a}return Object(m.a)(t,[{key:"renderMap",value:function(){var e=this,n=this.state,t=n.restaurants,a=n.selectedRestaurant;return r.a.createElement(re,{restaurants:t,selectedRestaurant:a,onMapLoaded:this.handleMapLoaded,onAddPlace:function(n){var t=n.position;e.setState({selectedRestaurant:{id:"0",icon:"https://maps.gstatic.com/mapfiles/place_api/icons/restaurant-71.png",restaurantName:"",address:"",position:{lat:t.lat(),lng:t.lng()},rating:0,rates:[],newRate:{comment:"",rating:0},marker:n}})}})}},{key:"renderFormReviews",value:function(){var e=this,n=this.state,t=n.selectedRestaurant,a=n.showReviews,i=t&&!a?r.a.createElement(b.a,{initialRating:t.newRate.rating,isHalfRating:!0,size:20,handleOnClick:function(n){t.newRate.rating=n,e.setState({selectedRestaurant:t})}}):null,o=t&&"0"===t.id?r.a.createElement("input",{name:"restaurantName",placeholder:"Write the restaurant name",style:{minWidth:"calc(100% - 40px)"},onChange:function(n){t.restaurantName=n.target.value,e.setState({selectedRestaurant:t})},value:t?t.restaurantName:""}):null;return r.a.createElement("form",{className:t&&!a?"selected":"",onSubmit:this.handleFormReviewSubmit},o,i,r.a.createElement("textarea",{name:"comment",style:{minWidth:"calc(100% - 40px)",minHeight:"150px"},placeholder:"Write your review",onChange:function(n){t.newRate.comment=n.target.value,e.setState({selectedRestaurant:t})},value:t&&t.newRate?t.newRate.comment:""}),r.a.createElement("button",{type:"submit"},"Save"))}},{key:"renderReviews",value:function(){var e=this,n=this.state,t=n.selectedRestaurant,a=n.showReviews,i=t&&a?t.rates.map((function(e){return r.a.createElement("div",{key:"".concat(e.comment,"_").concat(e.rating)},r.a.createElement("div",null,e.comment),r.a.createElement(b.a,{initialRating:e.rating,isReadOnly:!0,isHalfRating:!0}),r.a.createElement("hr",null))})):null;return r.a.createElement("div",{className:t&&a?"selected":""},i,r.a.createElement("button",{type:"button",onClick:function(){e.setState({selectedRestaurant:null,showReviews:!1})}},"Back"))}},{key:"renderList",value:function(){var e=this.state,n=e.restaurants,t=e.selectedRestaurant,a=e.filterRating,i=r.a.createElement(Z,{className:t?"":"selected",filterRating:a,restaurants:n,onClickRestaurant:this.handleClickRestaurant,onClickRestaurantRate:this.handleClickRestaurantRate});return r.a.createElement(r.a.Fragment,null,i,this.renderFormReviews(),this.renderReviews())}},{key:"render",value:function(){var e=this,n=this.state.filterRating,t=this.renderMap(),a=this.renderList();return r.a.createElement(T,{leftSide:t,rightSide:a,filterSpace:r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement("span",null,"Filter by rating: \xa0"),r.a.createElement("select",{name:"filterRating",style:{width:"150px"},value:n,onBlur:function(n){e.setState({filterRating:n.target.value})},onChange:function(n){e.setState({filterRating:n.target.value})}},r.a.createElement("option",{value:"0"},"-- All --"),r.a.createElement("option",{value:"1"},"1"),r.a.createElement("option",{value:"2"},"2"),r.a.createElement("option",{value:"3"},"3"),r.a.createElement("option",{value:"4"},"4"),r.a.createElement("option",{value:"5"},"5")))})}}]),t}(a.Component);o.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(u,null),r.a.createElement(ie,null)),document.getElementById("app-render")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.c4f5e2fe.chunk.js.map